/*! Readability2 | MIT License | github.com/mvasilkov/readability2 */if("undefined"==typeof window){window=exports}(function(){var d={Text:function(a){this.parentNode=null;this.textContent=a}};d.Text.prototype.compute=function(){this.chars=this.textContent.replace(/\s/gu,"").length;this.hyperchars=+this.parentNode.ofVariety(1)*this.chars};d.Text.prototype.canReject=function(){return 0==this.chars};d.Text.prototype.toString=function(){return this.textContent};Object.defineProperties(d.Text.prototype,{tags:{value:0},score:{value:0}});var e={};e.reject=new Set("applet canvas embed frame frameset head iframe link meta noembed noframes noscript object param script style template".split(" "));e.av=new Set("audio figcaption figure picture source track video".split(" "));e.block=new Set("address article aside blockquote div figcaption figure footer h1 h2 h3 h4 h5 h6 header hgroup li main nav p pre section".split(" "));e.autoclose=new Set("area base br col embed hr img input link meta param source track wbr".split(" "));e.heading=new Set("h1 h2 h3 h4 h5 h6 title".split(" "));
e.hyper=new Set(["button","option"]);e.bad=new Set(["footer","textarea"]);var g={badMultiplier:.1,rejectScore:9,rootMultiplier:.996,regexp:{space:/(?: |\t|\r|\n|\u00a0){2,}/g,comment:/^comment(?=-|_)/}};var h={Node:function(a){this.parentNode=null;this.childNodes=[];this.variety=0;this.burninate=!1;this.tagName=a}};h.Node.prototype.appendChild=function(a){if(null!==a.parentNode)throw Error("appendChild: Attempted reparenting");a.parentNode=this;this.childNodes.push(a);return a};h.Node.prototype.lastChild=function(){return 0==this.childNodes.length?null:this.childNodes[this.childNodes.length-1]};
h.Node.prototype.compute=function(a,b){var c=this;a=void 0===a?{sum:Infinity}:a;this.chars=this.hyperchars=this.sum=0;this.tags=1;this.childNodes.forEach(function(f){b!==f&&(f.compute(a),c.chars+=f.chars,c.hyperchars+=f.hyperchars,c.tags+=f.tags,c.sum+=f.score)});this.score=this.chars/this.tags*Math.log2((this.chars+1)/(this.hyperchars+1));this.ofVariety(2)&&(this.score*=g.badMultiplier);this.sum>a.sum&&(a.node=this,a.sum=this.sum)};h.Node.prototype.ofVariety=function(a){return 0!=(this.variety&a)};
h.Node.prototype.canReject=function(){return(this.score<g.rejectScore||this.tags>this.score+1)&&this.lowersParentScore()};h.Node.prototype.lowersParentScore=function(){if(null===this.parentNode)return!1;var a=this.parentNode.score;this.parentNode.compute(void 0,this);var b=a<this.parentNode.score;this.parentNode.score=a;return b};h.Node.prototype.containsText=function(){var a=0;this.childNodes.forEach(function(b){b instanceof d.Text&&(a+=b.chars)});return a>.5*this.chars};
h.Node.prototype.toString=function(){if(this.burninate)return e.block.has(this.tagName)?"\n\n":"";var a=this.childNodes.map(function(a){return a.toString()});e.block.has(this.tagName)&&(a.unshift("\n\n"),a.push("\n\n"));return a.join("")};var k={Cleaner:function(a){this.root=k.Cleaner.findRoot(a);this.root.containsText()||k.Cleaner.filter(this.root);k.Cleaner.strip(this.root)}};k.Cleaner.findRoot=function(a){var b=a.childNodes.filter(function(b){return b instanceof h.Node&&b.score>a.sum*g.rootMultiplier&&e.block.has(b.tagName)});return 1==b.length?b[0]:a};
k.Cleaner.filter=function(a){var b=[];a.childNodes.forEach(function(a,f){a instanceof h.Node&&a.canReject()&&(b.unshift(f),a.parentNode=null)});b.forEach(function(b){a.childNodes.splice(b,1)})};k.Cleaner.strip=function(a){for(var b,c=a.childNodes.length;c&&(b=a.childNodes[--c])&&!(b instanceof h.Node)&&b.canReject();)a.childNodes.pop(),b.parentNode=null;for(;(b=a.childNodes[0])&&!(b instanceof h.Node)&&b.canReject();)a.childNodes.shift(),b.parentNode=null};var l={CString:function(a){this.value=l.CString.normalize(a)}};l.CString.prototype.includes=function(a){return this.value.includes(l.CString.normalize(a))};l.CString.normalize=function(a){return a.toLowerCase()};var n={normalizeSpace:function(a){return a.replace(g.regexp.space,m(a.length))},parseInlineStyles:function(a){if("object"!=typeof process||"function"!=typeof process.chdir)return{};var b={};require("postcss").parse(a).nodes.forEach(function(a){b[a.prop]=a.value});return b}};function m(a){return function(b,c){if(0==c||c+b.length==a)return"";var f=0;for(c=b.indexOf("\n");-1!=c;c=b.indexOf("\n",c+1))++f;switch(f){case 0:return" ";case 1:return"\n"}return"\n\n"}};var p={Newline:function(){this.parentNode=null}};p.Newline.prototype.compute=function(){};p.Newline.prototype.canReject=function(){return!0};p.Newline.prototype.toString=function(){return"\n"};p.Newline.instance=new p.Newline;Object.defineProperties(p.Newline.prototype,{chars:{value:0},hyperchars:{value:0},tags:{value:0},score:{value:0}});var q={Title:function(){this.document={title:"",headings:[]}}};q.Title.prototype.append=function(a){if("title"==a.tagName)this.document.title=q.Title.normalizeTitle(a.toString());else{var b=q.Title.normalizeSpace(a.toString());b&&this.document.headings.push({content:b,node:a})}};
q.Title.prototype.getTitle=function(){var a=this.document,b=a.headings,c=a.title;if(0==b.length)return c;if(1==b.length)return q.Title.selectHeading(b[0]);if(c){var f=new l.CString(c);a=b.filter(function(a){return a.content.length<=c.length&&f.includes(a.content)}).sort(function(a,b){return b.content.length-a.content.length});if(a.length)return q.Title.selectHeading(a[0])}return q.Title.selectHeading(b[0])};q.Title.normalizeSpace=function(a){return n.normalizeSpace(a).replace(/\n{1,2}/gu," ")};
q.Title.normalizeTitle=function(a){a=a.split("::",1)[0];return q.Title.normalizeSpace("\n\n"+a+"\n\n")};q.Title.selectHeading=function(a){a.node.burninate=!0;return a.content};var r={Reader:function(){this._cur=this.root=new h.Node("---");this.title=new q.Title}};r.Reader.prototype.onopentag=function(a){a=a.toLowerCase();this._cur=this._cur.appendChild(new h.Node(a));this._cur.variety=this._cur.parentNode.variety;e.bad.has(a)&&(this._cur.variety|=2);e.hyper.has(a)&&(this._cur.variety|=1)};
r.Reader.prototype.onclosetag=function(a){a=a.toLowerCase();if(this._cur.tagName!=a||null==this._cur.parentNode)throw Error("onclosetag: Not balanced");var b=this._cur;this._cur=this._cur.parentNode;if(b.burninate||e.reject.has(a))this._cur.childNodes.pop();else if(e.heading.has(a))this.title.append(b);else switch(a){case "br":this._cur.childNodes.splice(-1,1,p.Newline.instance)}};
r.Reader.prototype.onattribute=function(a,b){a=a.toLowerCase();if(a.startsWith("data-modal-"))this._cur.variety|=2;else switch(a){case "href":if("a"==this._cur.tagName||"area"==this._cur.tagName)this._cur.variety|=1;break;case "id":g.regexp.comment.test(b)&&(this._cur.variety|=2);break;case "module":"air"==this._cur.tagName&&(this._cur.burninate=!0);break;case "style":"none"==n.parseInlineStyles(b).display&&(this._cur.variety|=2)}};
r.Reader.prototype.ontext=function(a){var b=this._cur.lastChild();b instanceof d.Text?b.textContent+=a:this._cur.appendChild(new d.Text(a))};var t={Readability:function(){this._title=this._result=null;var a=this.reader=new r.Reader;this.onopentag=a.onopentag.bind(a);this.onclosetag=a.onclosetag.bind(a);this.onattribute=a.onattribute.bind(a);this.ontext=a.ontext.bind(a)}};t.Readability.prototype.compute=function(){var a=this.reader.root,b={node:a,sum:0};if(null!=this._result)throw Error("This method can only be called once");a.compute(b);return this._result=b};
t.Readability.prototype.clean=function(){if(null==this._result)return"";null==this._cleaner&&(this._cleaner=new k.Cleaner(this._result.node));this.getTitle();return n.normalizeSpace(this._cleaner.root.toString())};t.Readability.prototype.getTitle=function(){null==this._title&&(this._title=this.reader.title.getTitle());return this._title};window.Readability=t.Readability;})()